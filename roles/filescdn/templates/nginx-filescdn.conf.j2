server {
    listen 8080;
    server_name _;
    root /mnt/filescdn;
    
    # Hide nginx version
    server_tokens off;
    
    # Disable directory indexing
    autoindex off;
    
    # Security headers
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    
    # Trust the proxy's X-Forwarded-* headers
    set_real_ip_from 127.0.0.1;  # or your proxy's IP
    set_real_ip_from 10.0.0.0/8;  # adjust to your internal network
    real_ip_header X-Forwarded-For;
    real_ip_recursive on;
    
    # Logging with real client IPs
    access_log /var/log/nginx/filescdn-access.log;
    error_log /var/log/nginx/filescdn-error.log;
    
    # Serve custom index.html from separate location
    location = / {
        root /var/www/cdn;
        try_files /index.html =404;
    }
    
    # Serve files directly
    location / {
        try_files $uri =404;
    }
    
    # Deny access to hidden files
    location ~ /\. {
        deny all;
        return 404;
    }
}